# 直接替换版本使用说明

`markdown-index-direct.sh` 是一个改进版本的 Markdown 标题序号生成工具，它可以直接替换选中的内容，无需手动复制粘贴操作。

## 快速开始

### 基本操作流程

1. **选中内容**：在任何文本编辑器中选中需要添加序号的 Markdown 内容
2. **触发脚本**：使用配置的快捷键触发脚本
3. **自动替换**：脚本会自动将选中内容替换为添加了序号的版本

### 工作流程

```
用户选中 Markdown 内容 → 按快捷键 → 脚本读取选中内容 → 处理并添加序号 → 自动替换原内容
```

## 功能特性

### 核心功能

- **直接替换**：无需复制粘贴，直接在原位置替换内容
- **多级标题支持**：支持 1-6 级 Markdown 标题的自动编号
- **智能序号生成**：根据标题层级自动生成合适的序号（如 1.1.1）
- **代码块保护**：自动识别并跳过代码块中的内容
- **重复运行支持**：可以多次运行，自动更新序号
- **静默处理**：在后台运行，不显示任何界面

### 序号规则

- **一级标题**：`# 1. 标题`
- **二级标题**：`## 1.1. 子标题`
- **三级标题**：`### 1.1.1. 小节`
- **跳级处理**：自动处理标题级别跳跃的情况
- **序号更新**：重复运行时会移除旧序号并生成新的

## 使用场景

### 适用情况

1. **技术文档编写**
   - API 文档的章节编号
   - 技术规范的结构化编排
   - 开发指南的层次化组织

2. **学习笔记整理**
   - 课程笔记的章节划分
   - 知识点的层次化整理
   - 复习资料的结构化编排

3. **项目文档管理**
   - 需求文档的功能模块编号
   - 设计文档的章节组织
   - 用户手册的步骤编号

### 工作环境

- **文本编辑器**：VS Code、Sublime Text、Atom 等
- **Markdown 编辑器**：Typora、Mark Text、MacDown 等
- **IDE 环境**：IntelliJ IDEA、WebStorm 等
- **在线编辑器**：GitHub、GitLab 等网页编辑器

## 用户体验优势

### 操作简化

- **一步完成**：选中 + 快捷键即可完成所有操作
- **无需切换**：不需要在应用间切换或使用剪贴板
- **即时生效**：处理结果立即显示在原位置
- **流畅体验**：整个过程快速、无缝、不影响工作流程

### 效率提升

- **减少步骤**：相比复制粘贴版本减少了 2 个操作步骤
- **降低出错**：避免了复制粘贴过程中可能的操作失误
- **提高专注**：减少操作干扰，保持编写专注度
- **批量处理**：可以快速处理多个文档片段

## 注意事项

### 使用要求

1. **内容选择**：必须选中包含 Markdown 标题的文本内容
2. **格式要求**：标题必须符合标准 Markdown 格式（以 # 开头）
3. **权限需求**：脚本需要系统的辅助功能权限来操作选中内容
4. **应用兼容**：在支持标准文本选择和替换的应用中使用

### 系统权限

首次使用时，系统可能会要求授予以下权限：

- **辅助功能权限**：用于读取选中内容和执行替换操作
- **自动化权限**：用于模拟键盘操作（复制/粘贴）

### 兼容性说明

- **操作系统**：macOS（依赖 AppleScript 和系统 API）
- **应用支持**：支持标准文本选择和剪贴板操作的应用
- **内容格式**：纯文本格式的 Markdown 内容

## 错误处理

### 常见问题

1. **无选中内容**：脚本会静默退出，不进行任何操作
2. **无标题内容**：如果选中内容不包含 Markdown 标题，脚本会退出
3. **权限不足**：如果缺少系统权限，操作可能失败
4. **应用不兼容**：某些应用可能不支持程序化的文本替换

### 故障排除

1. **检查选中内容**：确保选中了包含 Markdown 标题的文本
2. **验证权限设置**：在系统偏好设置中检查辅助功能权限
3. **测试应用兼容性**：在不同的文本编辑器中测试功能
4. **重启应用**：某些情况下重启编辑器可以解决权限问题

## 高级用法

### 批量处理

可以分段选择文档的不同部分，分别应用序号：

1. 选中第一部分内容，应用序号
2. 选中第二部分内容，应用序号
3. 重复直到完成整个文档

### 部分更新

当文档结构发生变化时：

1. 选中需要更新序号的部分
2. 运行脚本重新生成序号
3. 其他部分保持不变

### 模板应用

创建标准化的文档模板：

1. 准备包含标题结构的模板
2. 使用脚本添加序号
3. 保存为可重用的模板文件

## 最佳实践

### 文档结构规划

1. **层次清晰**：合理规划标题层级，避免过深的嵌套
2. **逻辑连贯**：确保标题之间的逻辑关系清晰
3. **命名规范**：使用简洁明确的标题名称

### 版本控制

1. **提交前处理**：在提交代码前统一添加序号
2. **分支管理**：在合并分支前确保文档序号的一致性
3. **变更追踪**：记录文档结构的重大变更

### 团队协作

1. **统一标准**：团队成员使用相同的序号格式
2. **定期更新**：定期检查和更新文档序号
3. **工具共享**：确保团队成员都能使用相同的工具

## 与复制粘贴版本的对比

| 特性 | 直接替换版本 | 复制粘贴版本 |
|------|-------------|-------------|
| 操作步骤 | 2步（选中+快捷键） | 4步（选中+复制+快捷键+粘贴） |
| 界面干扰 | 无 | 无 |
| 出错风险 | 低 | 中等 |
| 使用便利性 | 高 | 中等 |
| 系统权限要求 | 较高 | 较低 |
| 应用兼容性 | 中等 | 高 |

## 总结

`markdown-index-direct.sh` 通过直接替换选中内容的方式，进一步简化了 Markdown 标题序号的添加过程。它特别适合需要频繁处理文档结构的用户，能够显著提高工作效率和用户体验。

选择使用哪个版本主要取决于：
- **操作频率**：频繁使用建议选择直接替换版本
- **系统权限**：如果权限受限可以选择复制粘贴版本
- **应用兼容性**：根据主要使用的编辑器选择合适版本
- **个人偏好**：根据个人的操作习惯选择